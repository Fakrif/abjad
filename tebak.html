<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <title>Abjad Bahasa Indonesia</title>
</head>

<body>
    <header>
        <div>
            <h1>TEBAK HURUF</h1>
        </div>
    </header>
    <div class="container">
        <section>
            <p>Pilih huruf dibawah ini untuk ditampilkan!</p>

            <div id="pilih">

            </div>
        </section>
        <section class="section-btn hide">
            <div style="display: flex;justify-content: center;align-items: center;">
            <button id="mulaibtn" onclick="mulaiGame()">Mulai</button>
            </div>
            <p id="status">Klik mulai untuk memulai permainan</p>
            <div id="btn_layout">

            </div>
            <div class="setting">
                <label for="iptrange">Ubah Ukuran Huruf : <span id="sizeValue">60</span>px</label>
                <input type="range" id="slider" min="60" max="100" value="60">
            </div>
        </section>
        <p class="text-awal" style="padding: 9px;">Belum ada huruf yang dipilih</p>
        <div class="kembali">
            <a class="btn btn-back" href="index.html">Kembali ke Menu</a>
        </div>

    </div>

    <script>
        const btnlayout = document.getElementById("btn_layout")
        const slider = document.getElementById("slider")
        const pilih = document.getElementById("pilih")
        let targetHuruf = "";
        let gameBerjalan = false;
        let soal = []
        const sectionbtn = document.querySelector(".section-btn")
        const abjad = {
            A: "Apel", B: "Becak", C: "Cicak", D: "Durian", E: "Elang", F: "Flamingo",
            G: "Gajah", H: "Helikopter", I: "Ikan", J: "Jagung", K: "Kambing", L: "Lumba-lumba", M: "Mobil",
            N: "Nanas", O: "Orangutan", P: "Pisang", Q: "Quran", R: "Rumah", S: "Semangka", T: "Tikus",
            U: "Ular", V: "Vas bunga", W: "Wortel", X: "X-rayn", Y: "Yoyo", Z: "Zebra"
        }

        function displaypil() {
            let temp = ""
            for (let key in abjad) {
                const div = document.createElement("div")
                temp += `<input type="checkbox" id="huruf_${key}" class="cekbox"><label for=huruf_${key}>${key}</label>`
            }

            pilih.innerHTML = temp
        }
        displaypil()

        pilih.addEventListener("click", e => {
            if (e.target.classList.contains("cekbox")) {
                //let huruf=e.target.id.slice(-1)
                let arrcek = []
                const allCekbox = document.querySelectorAll(".cekbox")
                for (const huruf of allCekbox) {
                    if (huruf.checked) {
                        arrcek.push(huruf.id.slice(-1))
                    }
                }
                subhuruf(arrcek)
            }
        })

        function getSoal(){
            let arrcek = []
                const allCekbox = document.querySelectorAll(".cekbox")
                for (const huruf of allCekbox) {
                    if (huruf.checked) {
                        arrcek.push(huruf.id.slice(-1))
                    }
                }
            return arrcek
        }

        function subhuruf(arr) {
            btnlayout.innerHTML = ""
            if (arr.length == 0) {
                sectionbtn.classList.add("hide")
                document.querySelector(".text-awal").classList.remove("hide")
            } else {
                sectionbtn.classList.remove("hide")
                document.querySelector(".text-awal").classList.add("hide")

            }
            arr.forEach(a => {
                const img = document.createElement("img")
                img.src = `huruf/${a}.png`
                img.style.width = slider.value + "px"
                img.classList.add("huruf")
                img.onclick = () => {
                    if (gameBerjalan) cekJawaban(a);
                };
                btnlayout.appendChild(img)
            })
            //suku.appendChild(btn)
        }
        function ucapan(text) {
            const u = new SpeechSynthesisUtterance(text);
            u.lang = "id-ID";
            speechSynthesis.cancel();
            speechSynthesis.speak(u);
        }
        slider.addEventListener("input", function () {
            document.querySelectorAll(".huruf").forEach(e => {
                e.style.width = slider.value + "px";
            })
            document.getElementById("sizeValue").textContent = slider.value
        });

        async function mulaiGame() {            
            gameBerjalan = true;
            document.getElementById("status").textContent = "Permainan dimulai...";
            soal=await getSoal()
            await acaksoal()
            await putarSoal(); // langsung mulai soal pertama
        }
        function putarSoal() {
            const pertanyaan = soal.pop()
            if(!pertanyaan){
                document.getElementById("status").textContent = "selesai...üòä";
                ucapan("selamat kamu berhasil menyelesaikan permainan tebak huruf")
                return
            }
            targetHuruf = pertanyaan
            kalimat = `carilah huruf ${targetHuruf} untuk ${abjad[targetHuruf]}`
            ucapan(kalimat)
            document.getElementById("status").textContent = "üéß Dengarkan hurufnya...";

        }

        function acaksoal() {
            for (let i = soal.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [soal[i], soal[j]] = [soal[j], soal[i]];
            }
        }

        function cekJawaban(hurufDitebak) {
            if (hurufDitebak === targetHuruf) {
                ucapan("Hebat! kamu Benar!");
                document.getElementById("status").textContent = `‚úÖ Benar: ${hurufDitebak}`;
                setTimeout(() => {
                    putarSoal(); // lanjut soal baru setelah 1 detik
                }, 3000);
            } else {
                ucapan(`Salah. Coba lagi.${targetHuruf} untuk ${abjad[targetHuruf]}`);
                document.getElementById("status").textContent = `‚ùå Salah: ${hurufDitebak}`;
            }
        }

    </script>

</body>

</html>
